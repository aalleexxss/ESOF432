var e=require("path"),t=require("mime");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r,o=n(e),i=Object.freeze({subjectType:"input",force:!1,allowEmpty:!1}),s=Object.freeze({INPUT:"input",DRAG_N_DROP:"drag-n-drop"}),a=((r={})[s.INPUT]=["change"],r[s.DRAG_N_DROP]=["dragstart","drag","dragenter","drop","change","dragleave","dragend"],r);function f(e,t,n){t.forEach(function(t){!function(e,t,n){var r={bubbles:!0,cancelable:!0,detail:n};try{var o=new CustomEvent(t,r);Object.assign(o,{dataTransfer:n}),e.dispatchEvent(o)}catch(o){}}(e,t,n)})}function c(e){return"string"==typeof e?{filePath:e,encoding:"",mimeType:"",fileName:o.default.basename(e)}:{filePath:e.filePath,encoding:e.encoding||"",mimeType:e.mimeType||"",fileName:e.fileName||o.default.basename(e.filePath),fileContent:e.fileContent}}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function m(e,t,n){return(m=y()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&p(o,n.prototype),o}).apply(null,arguments)}function d(e){var t="function"==typeof Map?new Map:void 0;return(d=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return m(e,arguments,l(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),p(n,e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var h={message:'"subjectType" is not valid',tip:'Please look into docs to find supported "subjectType" values'},g={message:'"force" is not valid',tip:'Please look into docs to find supported "force" values'},T={message:'"allowEmpty" is not valid',tip:'Please look into docs to find supported "allowEmpty" values'},P={message:'"file encoding" is not valid',tip:'Please look into docs to find supported "encoding" values'},b={message:'"filePath" is not valid',tip:'Please look into docs to find supported "filePath" values'},w={message:'"mimeType" is not valid',tip:'Please look into docs to find supported "mimeType" values'},C={message:"given fixture file is empty",tip:'Please make sure you provide correct file or explicitly set "allowEmpty" to true'},E={message:'missing "filePath" or "fileName"',tip:'Please make sure you are passing either "filePath" or "fileName"'},F=function(e){var t,n;function r(t){var n;return n=e.call.apply(e,[this].concat([].slice.call(arguments,1)))||this,Error.captureStackTrace&&Error.captureStackTrace(v(n),r),n.name="[cypress-file-upload error]",n.message=t.message+".\n"+t.tip,n}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r}(d(Error)),S=Object.freeze({ASCII:"ascii",BASE64:"base64",BINARY:"binary",HEX:"hex",LATIN1:"latin1",UTF8:"utf8",UTF_8:"utf-8",UCS2:"ucs2",UCS_2:"ucs-2",UTF16LE:"utf16le",UTF_16LE:"utf-16le"}),O=Object.freeze({JSON:"json",JS:"js",COFFEE:"coffee",HTML:"html",TXT:"txt",CSV:"csv",PNG:"png",JPG:"jpg",JPEG:"jpeg",GIF:"gif",TIF:"tif",TIFF:"tiff",ZIP:"zip",PDF:"pdf",VCF:"vcf",SVG:"svg",XLS:"xls",XLSX:"xlsx",DOC:"doc",DOCX:"docx",MP3:"mp3"}),N=Object.values(S);function j(e){var t=e.filePath,n=e.fileName,r=e.encoding,o=e.mimeType,i=e.fileContent;if(r&&!N.includes(r))throw new F(P);if("string"!=typeof t&&!i)throw new F(b);if("string"!=typeof o)throw new F(w);if(!t&&!n)throw new F(E);return!0}var A,I,U=function(e){return e instanceof Cypress.Promise?e:(delete e.then,Cypress.Promise.resolve(e))},_=((A={})[S.ASCII]=function(e){return Cypress.Promise.resolve(e)},A[S.BASE64]=function(e,t){return U(Cypress.Blob.base64StringToBlob(e,t))},A[S.BINARY]=function(e,t){return U(Cypress.Blob.binaryStringToBlob(e,t))},A[S.HEX]=function(e){return Cypress.Promise.resolve(e)},A[S.LATIN1]=function(e){return Cypress.Promise.resolve(e)},A[S.UTF8]=function(e){return Cypress.Promise.resolve(e)},A[S.UTF_8]=function(e){return Cypress.Promise.resolve(e)},A[S.UCS2]=function(e){return Cypress.Promise.resolve(e)},A[S.UCS_2]=function(e){return Cypress.Promise.resolve(e)},A[S.UTF16LE]=function(e){return Cypress.Promise.resolve(e)},A[S.UTF_16LE]=function(e){return Cypress.Promise.resolve(e)},A),B=((I={})[O.JSON]=S.UTF8,I[O.JS]=S.UTF8,I[O.COFFEE]=S.UTF8,I[O.HTML]=S.UTF8,I[O.TXT]=S.UTF8,I[O.CSV]=S.UTF8,I[O.PNG]=S.BASE64,I[O.JPG]=S.BASE64,I[O.JPEG]=S.BASE64,I[O.GIF]=S.BASE64,I[O.TIF]=S.BASE64,I[O.TIFF]=S.BASE64,I[O.ZIP]=S.BASE64,I[O.PDF]=S.UTF8,I[O.VCF]=S.UTF8,I[O.SVG]=S.UTF8,I[O.XLS]=S.BINARY,I[O.XLSX]=S.BINARY,I[O.DOC]=S.BINARY,I[O.DOCX]=S.BINARY,I[O.MP3]=S.BINARY,I),R=S.UTF8;Cypress.Commands.add("attachFile",{prevSubject:!0},function(n,r,o){var l,p,y=(void 0===(l=o)&&(l={}),void 0===(p=i)&&(p={}),u({},p,l)),m=y.subjectType,d=y.force,v=y.allowEmpty;!function(e){var t=e.subjectType,n=e.force,r=e.allowEmpty;if(-1===Object.values(s).indexOf(t))throw new F(h);if("boolean"!=typeof n)throw new F(g);if("boolean"!=typeof r)throw new F(T)}({subjectType:m,force:d,allowEmpty:v});var P=(Array.isArray(r)?r:[r]).map(c).filter(j);return Cypress.cy.window({log:!1}).then(function(r){var o=d||function(e){return!("chrome"===(t=Cypress.browser).name&&t.majorVersion<73&&function(e){if(!e)throw new Error("Element cannot be empty");return Cypress.dom.isAttached(e)&&Cypress.dom.isVisible(e)}(e))||function(e){if(!e)throw new Error("Element cannot be empty");return Cypress.dom.isDetached(e)}(e);var t}(n);Cypress.Promise.all(P.map(function(n){return function(n,r){var o=n.filePath,i=n.encoding,s=n.fileName,a=n.mimeType||function(n){var r=e.extname(n).slice(1);return t.getType(r)}(o),f=i||function(t){var n=e.extname(t).slice(1);return B[n]||R}(o);return new Cypress.Promise(function(t){return function(e){var t=e.filePath,n=e.fileContent,r=e.fileEncoding;return n?U(n):Cypress.cy.fixture(t,r)}({filePath:o,fileContent:n.fileContent,fileEncoding:f}).then(function(t){return function(t){var n=t.fileName,r=t.fileContent,o=t.mimeType,i=t.window;return(0,_[t.encoding])(r,o).then(function(t){var s=t;return e.extname(n).slice(1)===O.JSON&&(s=JSON.stringify(r,null,2)),new i.File([s],n,{type:o})})}({fileContent:t,fileName:s,mimeType:a,encoding:f,window:r})}).then(t)})}(n,r)})).then(function(e){return e.filter(function(e){return function(e,t){if(!t&&0===e.size)throw new F(C);return!0}(e,v)})}).then(function(e){return function(e,t){var n=t.files,r=t.subjectType,o=t.force,i=new t.window.DataTransfer;if(n.forEach(function(e){return i.items.add(e)}),r===s.INPUT){var c=e[0];c.files=i.files,o&&f(c,a[r],i)}else if(r===s.DRAG_N_DROP){var u=e[0].querySelectorAll('input[type="file"]');if(1===u.length){var l=u[0];l.files=i.files,o&&f(l,a[r],i)}else{var p=e[0];p.files=i.files,o&&f(p,a[r],i)}}}(n,{files:e,subjectType:m,force:o,window:r}),e}).then(function(e){return Cypress.log({name:"attachFile",displayName:"FILE",message:e.reduce(function(e,t){return""+(e.length>0?e+", ":e)+t.name},"")})})}),Cypress.cy.wrap(n,{log:!1})});
//# sourceMappingURL=bundle.js.map
